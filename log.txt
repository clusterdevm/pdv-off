05-07-2021 00:58:03 select p.id produto_id, 
        case when pgri_1.descricao <> '' and pgri_2.descricao <> '' then 
        p.descricao ||' '|| grd_1.descricao_resumida||' '||
        pgri_1.descricao|| ' '||grd_2.descricao_resumida||' '||pgri_2.descricao
        when pgri_1.descricao <> ''  then
        p.descricao||' '||pgri_1.descricao
        else
        p.descricao end as descricao,
       p.gtin, p.referencia, p.ativo, p.ncm_id ncm, p.origemmercadoria origem_mercadoria,
       p.tipo_produto, p.cest, p.pesobruto, p.pesoliquido,
       sg.descricao n_subgrupo,
       pg.descricao n_grupo, pm.descricao n_marca,
       pu.un medida_descricao, pc.descricao n_colecao, pu.id unidade_medida_id,
       pgrd.gtin_grade,
       pes.saldo_gerencial,
       pa.descricao n_estoque,
       ppv.valor, tp.descricao n_tabela,
       ncm.descricao n_ncm,
       pgrd.id gradeamento_id, 
 ppc.custo_markup custo_unitario 
from produtos p inner join produtos_empresa pe
                      on pe.produto_id = p.id
                      inner join produtos_estoque pes
                      on pes.produto_empresa_id = pe.id
                      inner join produtos_armazenamento pa
                      on pa.id  = pes.produto_armazenamento_id
                      and pa.id = '1'
                      and pa.empresa_id = pe.empresa_id
                      inner join produtos_preco_venda ppv
                      on ppv.produto_empresa_id = pe.id
                      and ppv.tabela_id = '3'
                      left join produtos_preco_custo ppc
                      on ppc.id = pe.preco_custo_id
                      inner join tabela_preco tp
                      on tp.id = ppv.tabela_id
                      left join produtos_subgrupos sg
                      on sg.id = p.subgrupo_id
                      left join produtos_grupos pg
                      on pg.id = sg.grupo_id
                      left join produtos_marcas pm
                      on pm.id = p.marca_id
                      left join produtos_unidades pu
                      on pu.id = p.unidade_id
                      left join produtos_colecoes pc
                      on pc.id = p.colecao_id
                      left join lista_ncm ncm
                      on ncm.ncm = p.ncm_id
                      left join produtos_gradeamento pgrd
                      on pgrd.produto_id  = p.id
                      left join produtos_grades_itens pgri_1
                      on pgri_1.id = pgrd.grade_item_id
                      left join produtos_grades grd_1
                      on grd_1.id = pgri_1.grade_id
                      left join produtos_grades_itens pgri_2
                      on pgri_2.id = pgrd.grade_item2_id
                      left join produtos_grades grd_2
                      on grd_2.id = pgri_2.grade_id
where
     1 = 1
and ( 
p.id = '35' or 
 p.gtin = '35' or pgrd.gtin ='35' or pgrd.gtin_grade = '35' )
order by 2

05-07-2021 00:58:04 select p.id produto_id, 
        case when pgri_1.descricao <> '' and pgri_2.descricao <> '' then 
        p.descricao ||' '|| grd_1.descricao_resumida||' '||
        pgri_1.descricao|| ' '||grd_2.descricao_resumida||' '||pgri_2.descricao
        when pgri_1.descricao <> ''  then
        p.descricao||' '||pgri_1.descricao
        else
        p.descricao end as descricao,
       p.gtin, p.referencia, p.ativo, p.ncm_id ncm, p.origemmercadoria origem_mercadoria,
       p.tipo_produto, p.cest, p.pesobruto, p.pesoliquido,
       sg.descricao n_subgrupo,
       pg.descricao n_grupo, pm.descricao n_marca,
       pu.un medida_descricao, pc.descricao n_colecao, pu.id unidade_medida_id,
       pgrd.gtin_grade,
       pes.saldo_gerencial,
       pa.descricao n_estoque,
       ppv.valor, tp.descricao n_tabela,
       ncm.descricao n_ncm,
       pgrd.id gradeamento_id, 
 ppc.custo_markup custo_unitario 
from produtos p inner join produtos_empresa pe
                      on pe.produto_id = p.id
                      inner join produtos_estoque pes
                      on pes.produto_empresa_id = pe.id
                      inner join produtos_armazenamento pa
                      on pa.id  = pes.produto_armazenamento_id
                      and pa.id = '1'
                      and pa.empresa_id = pe.empresa_id
                      inner join produtos_preco_venda ppv
                      on ppv.produto_empresa_id = pe.id
                      and ppv.tabela_id = '3'
                      left join produtos_preco_custo ppc
                      on ppc.id = pe.preco_custo_id
                      inner join tabela_preco tp
                      on tp.id = ppv.tabela_id
                      left join produtos_subgrupos sg
                      on sg.id = p.subgrupo_id
                      left join produtos_grupos pg
                      on pg.id = sg.grupo_id
                      left join produtos_marcas pm
                      on pm.id = p.marca_id
                      left join produtos_unidades pu
                      on pu.id = p.unidade_id
                      left join produtos_colecoes pc
                      on pc.id = p.colecao_id
                      left join lista_ncm ncm
                      on ncm.ncm = p.ncm_id
                      left join produtos_gradeamento pgrd
                      on pgrd.produto_id  = p.id
                      left join produtos_grades_itens pgri_1
                      on pgri_1.id = pgrd.grade_item_id
                      left join produtos_grades grd_1
                      on grd_1.id = pgri_1.grade_id
                      left join produtos_grades_itens pgri_2
                      on pgri_2.id = pgrd.grade_item2_id
                      left join produtos_grades grd_2
                      on grd_2.id = pgri_2.grade_id
where
     1 = 1
and ( 
p.id = '565' or 
 p.gtin = '565' or pgrd.gtin ='565' or pgrd.gtin_grade = '565' )
order by 2

05-07-2021 00:58:05 select p.id produto_id, 
        case when pgri_1.descricao <> '' and pgri_2.descricao <> '' then 
        p.descricao ||' '|| grd_1.descricao_resumida||' '||
        pgri_1.descricao|| ' '||grd_2.descricao_resumida||' '||pgri_2.descricao
        when pgri_1.descricao <> ''  then
        p.descricao||' '||pgri_1.descricao
        else
        p.descricao end as descricao,
       p.gtin, p.referencia, p.ativo, p.ncm_id ncm, p.origemmercadoria origem_mercadoria,
       p.tipo_produto, p.cest, p.pesobruto, p.pesoliquido,
       sg.descricao n_subgrupo,
       pg.descricao n_grupo, pm.descricao n_marca,
       pu.un medida_descricao, pc.descricao n_colecao, pu.id unidade_medida_id,
       pgrd.gtin_grade,
       pes.saldo_gerencial,
       pa.descricao n_estoque,
       ppv.valor, tp.descricao n_tabela,
       ncm.descricao n_ncm,
       pgrd.id gradeamento_id, 
 ppc.custo_markup custo_unitario 
from produtos p inner join produtos_empresa pe
                      on pe.produto_id = p.id
                      inner join produtos_estoque pes
                      on pes.produto_empresa_id = pe.id
                      inner join produtos_armazenamento pa
                      on pa.id  = pes.produto_armazenamento_id
                      and pa.id = '1'
                      and pa.empresa_id = pe.empresa_id
                      inner join produtos_preco_venda ppv
                      on ppv.produto_empresa_id = pe.id
                      and ppv.tabela_id = '3'
                      left join produtos_preco_custo ppc
                      on ppc.id = pe.preco_custo_id
                      inner join tabela_preco tp
                      on tp.id = ppv.tabela_id
                      left join produtos_subgrupos sg
                      on sg.id = p.subgrupo_id
                      left join produtos_grupos pg
                      on pg.id = sg.grupo_id
                      left join produtos_marcas pm
                      on pm.id = p.marca_id
                      left join produtos_unidades pu
                      on pu.id = p.unidade_id
                      left join produtos_colecoes pc
                      on pc.id = p.colecao_id
                      left join lista_ncm ncm
                      on ncm.ncm = p.ncm_id
                      left join produtos_gradeamento pgrd
                      on pgrd.produto_id  = p.id
                      left join produtos_grades_itens pgri_1
                      on pgri_1.id = pgrd.grade_item_id
                      left join produtos_grades grd_1
                      on grd_1.id = pgri_1.grade_id
                      left join produtos_grades_itens pgri_2
                      on pgri_2.id = pgrd.grade_item2_id
                      left join produtos_grades grd_2
                      on grd_2.id = pgri_2.grade_id
where
     1 = 1
and ( 
p.id = '50' or 
 p.gtin = '50' or pgrd.gtin ='50' or pgrd.gtin_grade = '50' )
order by 2

05-07-2021 00:58:07 select p.id produto_id, 
        case when pgri_1.descricao <> '' and pgri_2.descricao <> '' then 
        p.descricao ||' '|| grd_1.descricao_resumida||' '||
        pgri_1.descricao|| ' '||grd_2.descricao_resumida||' '||pgri_2.descricao
        when pgri_1.descricao <> ''  then
        p.descricao||' '||pgri_1.descricao
        else
        p.descricao end as descricao,
       p.gtin, p.referencia, p.ativo, p.ncm_id ncm, p.origemmercadoria origem_mercadoria,
       p.tipo_produto, p.cest, p.pesobruto, p.pesoliquido,
       sg.descricao n_subgrupo,
       pg.descricao n_grupo, pm.descricao n_marca,
       pu.un medida_descricao, pc.descricao n_colecao, pu.id unidade_medida_id,
       pgrd.gtin_grade,
       pes.saldo_gerencial,
       pa.descricao n_estoque,
       ppv.valor, tp.descricao n_tabela,
       ncm.descricao n_ncm,
       pgrd.id gradeamento_id, 
 ppc.custo_markup custo_unitario 
from produtos p inner join produtos_empresa pe
                      on pe.produto_id = p.id
                      inner join produtos_estoque pes
                      on pes.produto_empresa_id = pe.id
                      inner join produtos_armazenamento pa
                      on pa.id  = pes.produto_armazenamento_id
                      and pa.id = '1'
                      and pa.empresa_id = pe.empresa_id
                      inner join produtos_preco_venda ppv
                      on ppv.produto_empresa_id = pe.id
                      and ppv.tabela_id = '3'
                      left join produtos_preco_custo ppc
                      on ppc.id = pe.preco_custo_id
                      inner join tabela_preco tp
                      on tp.id = ppv.tabela_id
                      left join produtos_subgrupos sg
                      on sg.id = p.subgrupo_id
                      left join produtos_grupos pg
                      on pg.id = sg.grupo_id
                      left join produtos_marcas pm
                      on pm.id = p.marca_id
                      left join produtos_unidades pu
                      on pu.id = p.unidade_id
                      left join produtos_colecoes pc
                      on pc.id = p.colecao_id
                      left join lista_ncm ncm
                      on ncm.ncm = p.ncm_id
                      left join produtos_gradeamento pgrd
                      on pgrd.produto_id  = p.id
                      left join produtos_grades_itens pgri_1
                      on pgri_1.id = pgrd.grade_item_id
                      left join produtos_grades grd_1
                      on grd_1.id = pgri_1.grade_id
                      left join produtos_grades_itens pgri_2
                      on pgri_2.id = pgrd.grade_item2_id
                      left join produtos_grades grd_2
                      on grd_2.id = pgri_2.grade_id
where
     1 = 1
and ( 
p.id = '1' or 
 p.gtin = '1' or pgrd.gtin ='1' or pgrd.gtin_grade = '1' )
order by 2

05-07-2021 00:58:08 select p.id produto_id, 
        case when pgri_1.descricao <> '' and pgri_2.descricao <> '' then 
        p.descricao ||' '|| grd_1.descricao_resumida||' '||
        pgri_1.descricao|| ' '||grd_2.descricao_resumida||' '||pgri_2.descricao
        when pgri_1.descricao <> ''  then
        p.descricao||' '||pgri_1.descricao
        else
        p.descricao end as descricao,
       p.gtin, p.referencia, p.ativo, p.ncm_id ncm, p.origemmercadoria origem_mercadoria,
       p.tipo_produto, p.cest, p.pesobruto, p.pesoliquido,
       sg.descricao n_subgrupo,
       pg.descricao n_grupo, pm.descricao n_marca,
       pu.un medida_descricao, pc.descricao n_colecao, pu.id unidade_medida_id,
       pgrd.gtin_grade,
       pes.saldo_gerencial,
       pa.descricao n_estoque,
       ppv.valor, tp.descricao n_tabela,
       ncm.descricao n_ncm,
       pgrd.id gradeamento_id, 
 ppc.custo_markup custo_unitario 
from produtos p inner join produtos_empresa pe
                      on pe.produto_id = p.id
                      inner join produtos_estoque pes
                      on pes.produto_empresa_id = pe.id
                      inner join produtos_armazenamento pa
                      on pa.id  = pes.produto_armazenamento_id
                      and pa.id = '1'
                      and pa.empresa_id = pe.empresa_id
                      inner join produtos_preco_venda ppv
                      on ppv.produto_empresa_id = pe.id
                      and ppv.tabela_id = '3'
                      left join produtos_preco_custo ppc
                      on ppc.id = pe.preco_custo_id
                      inner join tabela_preco tp
                      on tp.id = ppv.tabela_id
                      left join produtos_subgrupos sg
                      on sg.id = p.subgrupo_id
                      left join produtos_grupos pg
                      on pg.id = sg.grupo_id
                      left join produtos_marcas pm
                      on pm.id = p.marca_id
                      left join produtos_unidades pu
                      on pu.id = p.unidade_id
                      left join produtos_colecoes pc
                      on pc.id = p.colecao_id
                      left join lista_ncm ncm
                      on ncm.ncm = p.ncm_id
                      left join produtos_gradeamento pgrd
                      on pgrd.produto_id  = p.id
                      left join produtos_grades_itens pgri_1
                      on pgri_1.id = pgrd.grade_item_id
                      left join produtos_grades grd_1
                      on grd_1.id = pgri_1.grade_id
                      left join produtos_grades_itens pgri_2
                      on pgri_2.id = pgrd.grade_item2_id
                      left join produtos_grades grd_2
                      on grd_2.id = pgri_2.grade_id
where
     1 = 1
and ( 
p.id = '1' or 
 p.gtin = '1' or pgrd.gtin ='1' or pgrd.gtin_grade = '1' )
 and pgrd.id = '1'
order by 2

05-07-2021 01:02:15 select sum(COALESCE(vl_produtos,0)) as tprodutos ,
       sum(COALESCE(vl_outras_despesas,0)) as tdespesas ,
       sum(COALESCE(vl_acrescimo,0)) as tacrescimo ,
       sum(COALESCE(vl_desconto,0)) as tdesconto ,
       sum(COALESCE(bc_icms,0)) as tbc_icms ,
       sum(COALESCE(bc_ipi,0)) as tbc_ipi ,
       sum(COALESCE(bc_icms_st,0)) as tbc_icms_st ,
       sum(COALESCE(bc_cofins,0)) as tbc_cofins ,
       sum(COALESCE(bc_pis,0)) as tbc_pis ,
       sum(COALESCE(vl_ipi,0)) as tipi ,
       sum(COALESCE(vl_pis,0)) as tpis ,
       0 tpis_st ,
       sum(COALESCE(vl_retpis,0)) as tret_pis ,
       sum(COALESCE(vl_cofins,0)) as tcofins ,
       0 tcofins_st ,
       sum(COALESCE(vl_retcofins,0)) as tret_cofins ,
       sum(COALESCE(vl_icms,0)) as ticms ,
       sum(COALESCE(vl_icms_st,0)) as ticms_st ,
       sum(COALESCE(vl_ibpt,0)) as tibpt ,
       sum(COALESCE(peso_liquido,0)) as tpeso_liquido ,
       sum(COALESCE(peso_bruto,0)) as tpeso_bruto ,
       sum(COALESCE(vl_frete,0)) as tfrete ,
       sum(COALESCE(vl_retcsll,0)) as tret_csll ,
       sum(COALESCE(bc_irrf,0)) as tbc_irrf ,
       sum(COALESCE(vl_irrf,0)) as tirrf ,
       sum(COALESCE(bc_retprev,0)) as tbc_retprev ,
       sum(COALESCE(vl_retprev,0)) as tret_prev ,
       sum(COALESCE(vl_seguro,0)) as tseguro ,
       sum(COALESCE(vl_siscomex,0)) as tsiscomex 
 from venda_itens 
 where venda_id = '000020015'

05-07-2021 01:03:43 select p.id produto_id, 
        case when pgri_1.descricao <> '' and pgri_2.descricao <> '' then 
        p.descricao ||' '|| grd_1.descricao_resumida||' '||
        pgri_1.descricao|| ' '||grd_2.descricao_resumida||' '||pgri_2.descricao
        when pgri_1.descricao <> ''  then
        p.descricao||' '||pgri_1.descricao
        else
        p.descricao end as descricao,
       p.gtin, p.referencia, p.ativo, p.ncm_id ncm, p.origemmercadoria origem_mercadoria,
       p.tipo_produto, p.cest, p.pesobruto, p.pesoliquido,
       sg.descricao n_subgrupo,
       pg.descricao n_grupo, pm.descricao n_marca,
       pu.un medida_descricao, pc.descricao n_colecao, pu.id unidade_medida_id,
       pgrd.gtin_grade,
       pes.saldo_gerencial,
       pa.descricao n_estoque,
       ppv.valor, tp.descricao n_tabela,
       ncm.descricao n_ncm,
       pgrd.id gradeamento_id, 
 ppc.custo_markup custo_unitario 
from produtos p inner join produtos_empresa pe
                      on pe.produto_id = p.id
                      inner join produtos_estoque pes
                      on pes.produto_empresa_id = pe.id
                      inner join produtos_armazenamento pa
                      on pa.id  = pes.produto_armazenamento_id
                      and pa.id = '1'
                      and pa.empresa_id = pe.empresa_id
                      inner join produtos_preco_venda ppv
                      on ppv.produto_empresa_id = pe.id
                      and ppv.tabela_id = '3'
                      left join produtos_preco_custo ppc
                      on ppc.id = pe.preco_custo_id
                      inner join tabela_preco tp
                      on tp.id = ppv.tabela_id
                      left join produtos_subgrupos sg
                      on sg.id = p.subgrupo_id
                      left join produtos_grupos pg
                      on pg.id = sg.grupo_id
                      left join produtos_marcas pm
                      on pm.id = p.marca_id
                      left join produtos_unidades pu
                      on pu.id = p.unidade_id
                      left join produtos_colecoes pc
                      on pc.id = p.colecao_id
                      left join lista_ncm ncm
                      on ncm.ncm = p.ncm_id
                      left join produtos_gradeamento pgrd
                      on pgrd.produto_id  = p.id
                      left join produtos_grades_itens pgri_1
                      on pgri_1.id = pgrd.grade_item_id
                      left join produtos_grades grd_1
                      on grd_1.id = pgri_1.grade_id
                      left join produtos_grades_itens pgri_2
                      on pgri_2.id = pgrd.grade_item2_id
                      left join produtos_grades grd_2
                      on grd_2.id = pgri_2.grade_id
where
     1 = 1
and ( 
p.id = '5' or 
 p.gtin = '5' or pgrd.gtin ='5' or pgrd.gtin_grade = '5' )
order by 2

05-07-2021 01:03:45 select p.id produto_id, 
        case when pgri_1.descricao <> '' and pgri_2.descricao <> '' then 
        p.descricao ||' '|| grd_1.descricao_resumida||' '||
        pgri_1.descricao|| ' '||grd_2.descricao_resumida||' '||pgri_2.descricao
        when pgri_1.descricao <> ''  then
        p.descricao||' '||pgri_1.descricao
        else
        p.descricao end as descricao,
       p.gtin, p.referencia, p.ativo, p.ncm_id ncm, p.origemmercadoria origem_mercadoria,
       p.tipo_produto, p.cest, p.pesobruto, p.pesoliquido,
       sg.descricao n_subgrupo,
       pg.descricao n_grupo, pm.descricao n_marca,
       pu.un medida_descricao, pc.descricao n_colecao, pu.id unidade_medida_id,
       pgrd.gtin_grade,
       pes.saldo_gerencial,
       pa.descricao n_estoque,
       ppv.valor, tp.descricao n_tabela,
       ncm.descricao n_ncm,
       pgrd.id gradeamento_id, 
 ppc.custo_markup custo_unitario 
from produtos p inner join produtos_empresa pe
                      on pe.produto_id = p.id
                      inner join produtos_estoque pes
                      on pes.produto_empresa_id = pe.id
                      inner join produtos_armazenamento pa
                      on pa.id  = pes.produto_armazenamento_id
                      and pa.id = '1'
                      and pa.empresa_id = pe.empresa_id
                      inner join produtos_preco_venda ppv
                      on ppv.produto_empresa_id = pe.id
                      and ppv.tabela_id = '3'
                      left join produtos_preco_custo ppc
                      on ppc.id = pe.preco_custo_id
                      inner join tabela_preco tp
                      on tp.id = ppv.tabela_id
                      left join produtos_subgrupos sg
                      on sg.id = p.subgrupo_id
                      left join produtos_grupos pg
                      on pg.id = sg.grupo_id
                      left join produtos_marcas pm
                      on pm.id = p.marca_id
                      left join produtos_unidades pu
                      on pu.id = p.unidade_id
                      left join produtos_colecoes pc
                      on pc.id = p.colecao_id
                      left join lista_ncm ncm
                      on ncm.ncm = p.ncm_id
                      left join produtos_gradeamento pgrd
                      on pgrd.produto_id  = p.id
                      left join produtos_grades_itens pgri_1
                      on pgri_1.id = pgrd.grade_item_id
                      left join produtos_grades grd_1
                      on grd_1.id = pgri_1.grade_id
                      left join produtos_grades_itens pgri_2
                      on pgri_2.id = pgrd.grade_item2_id
                      left join produtos_grades grd_2
                      on grd_2.id = pgri_2.grade_id
where
     1 = 1
and ( 
p.id = '50' or 
 p.gtin = '50' or pgrd.gtin ='50' or pgrd.gtin_grade = '50' )
order by 2

05-07-2021 01:03:48 select p.id produto_id, 
        case when pgri_1.descricao <> '' and pgri_2.descricao <> '' then 
        p.descricao ||' '|| grd_1.descricao_resumida||' '||
        pgri_1.descricao|| ' '||grd_2.descricao_resumida||' '||pgri_2.descricao
        when pgri_1.descricao <> ''  then
        p.descricao||' '||pgri_1.descricao
        else
        p.descricao end as descricao,
       p.gtin, p.referencia, p.ativo, p.ncm_id ncm, p.origemmercadoria origem_mercadoria,
       p.tipo_produto, p.cest, p.pesobruto, p.pesoliquido,
       sg.descricao n_subgrupo,
       pg.descricao n_grupo, pm.descricao n_marca,
       pu.un medida_descricao, pc.descricao n_colecao, pu.id unidade_medida_id,
       pgrd.gtin_grade,
       pes.saldo_gerencial,
       pa.descricao n_estoque,
       ppv.valor, tp.descricao n_tabela,
       ncm.descricao n_ncm,
       pgrd.id gradeamento_id, 
 ppc.custo_markup custo_unitario 
from produtos p inner join produtos_empresa pe
                      on pe.produto_id = p.id
                      inner join produtos_estoque pes
                      on pes.produto_empresa_id = pe.id
                      inner join produtos_armazenamento pa
                      on pa.id  = pes.produto_armazenamento_id
                      and pa.id = '1'
                      and pa.empresa_id = pe.empresa_id
                      inner join produtos_preco_venda ppv
                      on ppv.produto_empresa_id = pe.id
                      and ppv.tabela_id = '3'
                      left join produtos_preco_custo ppc
                      on ppc.id = pe.preco_custo_id
                      inner join tabela_preco tp
                      on tp.id = ppv.tabela_id
                      left join produtos_subgrupos sg
                      on sg.id = p.subgrupo_id
                      left join produtos_grupos pg
                      on pg.id = sg.grupo_id
                      left join produtos_marcas pm
                      on pm.id = p.marca_id
                      left join produtos_unidades pu
                      on pu.id = p.unidade_id
                      left join produtos_colecoes pc
                      on pc.id = p.colecao_id
                      left join lista_ncm ncm
                      on ncm.ncm = p.ncm_id
                      left join produtos_gradeamento pgrd
                      on pgrd.produto_id  = p.id
                      left join produtos_grades_itens pgri_1
                      on pgri_1.id = pgrd.grade_item_id
                      left join produtos_grades grd_1
                      on grd_1.id = pgri_1.grade_id
                      left join produtos_grades_itens pgri_2
                      on pgri_2.id = pgrd.grade_item2_id
                      left join produtos_grades grd_2
                      on grd_2.id = pgri_2.grade_id
where
     1 = 1
and ( 
p.id = '50' or 
 p.gtin = '50' or pgrd.gtin ='50' or pgrd.gtin_grade = '50' )
order by 2

05-07-2021 01:04:01 select sum(COALESCE(vl_produtos,0)) as tprodutos ,
       sum(COALESCE(vl_outras_despesas,0)) as tdespesas ,
       sum(COALESCE(vl_acrescimo,0)) as tacrescimo ,
       sum(COALESCE(vl_desconto,0)) as tdesconto ,
       sum(COALESCE(bc_icms,0)) as tbc_icms ,
       sum(COALESCE(bc_ipi,0)) as tbc_ipi ,
       sum(COALESCE(bc_icms_st,0)) as tbc_icms_st ,
       sum(COALESCE(bc_cofins,0)) as tbc_cofins ,
       sum(COALESCE(bc_pis,0)) as tbc_pis ,
       sum(COALESCE(vl_ipi,0)) as tipi ,
       sum(COALESCE(vl_pis,0)) as tpis ,
       0 tpis_st ,
       sum(COALESCE(vl_retpis,0)) as tret_pis ,
       sum(COALESCE(vl_cofins,0)) as tcofins ,
       0 tcofins_st ,
       sum(COALESCE(vl_retcofins,0)) as tret_cofins ,
       sum(COALESCE(vl_icms,0)) as ticms ,
       sum(COALESCE(vl_icms_st,0)) as ticms_st ,
       sum(COALESCE(vl_ibpt,0)) as tibpt ,
       sum(COALESCE(peso_liquido,0)) as tpeso_liquido ,
       sum(COALESCE(peso_bruto,0)) as tpeso_bruto ,
       sum(COALESCE(vl_frete,0)) as tfrete ,
       sum(COALESCE(vl_retcsll,0)) as tret_csll ,
       sum(COALESCE(bc_irrf,0)) as tbc_irrf ,
       sum(COALESCE(vl_irrf,0)) as tirrf ,
       sum(COALESCE(bc_retprev,0)) as tbc_retprev ,
       sum(COALESCE(vl_retprev,0)) as tret_prev ,
       sum(COALESCE(vl_seguro,0)) as tseguro ,
       sum(COALESCE(vl_siscomex,0)) as tsiscomex 
 from venda_itens 
 where venda_id = '000020016'

